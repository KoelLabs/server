import sys
import os
from scipy.io import wavfile
import numpy as np

sys.path.append(os.path.dirname(os.path.dirname(os.path.abspath(__file__))))

from src.phoneme_utils import needleman_wunsch


user_speech_timestamps = [
    ("j", 0.601336302895323, 0.621380846325167),
    ("u", 0.6414253897550111, 0.6614699331848553),
    ("ɡ", 0.8218262806236081, 0.8418708240534521),
    ("ɑ", 0.8619153674832962, 0.8819599109131403),
    ("t", 1.042316258351893, 1.0623608017817372),
    ("ə", 1.0824053452115814, 1.1024498886414253),
    ("s", 1.22271714922049, 1.2628062360801782),
    ("t", 1.3028953229398665, 1.3229398663697105),
    ("eɪ", 1.3429844097995547, 1.3630289532293987),
    ("ʌ", 1.5835189309576838, 1.6035634743875278),
    ("w", 1.7639198218262806, 1.7839643652561248),
    ("ɝ", 1.7839643652561248, 1.8040089086859687),
    ("d", 2.024498886414254, 2.044543429844098),
    ("ɔ", 2.1648106904231628, 2.1848552338530065),
    ("l", 2.305122494432071, 2.3251670378619154),
    ("ð", 2.385300668151448, 2.405345211581292),
    ("ə", 2.405345211581292, 2.425389755011136),
    ("t", 2.505567928730512, 2.5256124721603563),
    ("aɪ", 2.605790645879733, 2.625835189309577),
    ("m", 2.906458797327394, 2.9265033407572383),
]
actor_speech_timestamps = [
    ("j", 0.24160443037974685, 0.2617381329113924),
    ("u", 0.2617381329113924, 0.281871835443038),
    ("ɡ", 0.34227294303797473, 0.36240664556962027),
    ("ɑ", 0.38254034810126586, 0.40267405063291145),
    ("t", 0.4429414556962025, 0.4630751582278481),
    ("ʌ", 0.4832088607594937, 0.5033425632911394),
    ("s", 0.6845458860759495, 0.7046795886075949),
    ("t", 0.7650806962025317, 0.7852143987341773),
    ("eɪ", 0.8053481012658229, 0.8254818037974684),
    ("æ", 1.0872199367088609, 1.1073536392405066),
    ("n", 1.22815585443038, 1.2482895569620254),
    ("l", 1.369091772151899, 1.3892254746835444),
    ("ɝ", 1.4093591772151899, 1.4294928797468356),
    ("t", 1.6106962025316458, 1.630829905063291),
    ("ɔ", 2.0536376582278484, 2.073771360759494),
    ("l", 2.1945735759493674, 2.214707278481013),
    ("ð", 2.27510838607595, 2.295242088607595),
    ("ʌ", 2.295242088607595, 2.3153757911392407),
    ("t", 2.416044303797469, 2.436178006329114),
    ("aɪ", 2.4764454113924055, 2.4965791139240507),
    ("m", 2.7985846518987345, 2.8187183544303798),
]


user_speech_transcribed = "juɡɑtəsteɪʌwɝdɔlðətaɪm"
actor_speech_transcribed = "juɡɑtʌsteɪænlɝtɔlðʌtaɪm"

output, output2 = needleman_wunsch(
    user_speech_timestamps,
    actor_speech_timestamps,
    substitution_func=lambda x, y: 0 if x == y[0] else -1,
)

print("output", output)  # returns with dash at front of sequence
print("output2", output2)

output_transcript, output2_transcript = needleman_wunsch(
    user_speech_transcribed,
    actor_speech_transcribed,
    insertion_func=lambda x: -1,
    deletion_func=lambda x: -1,
    substitution_func=lambda x, y: 0 if x == y[0] else -1,
)
print("output_transcript", output_transcript)  # return with dash in middle of sequence
print("output2_transcript", output2_transcript)
